<!DOCTYPE html>
<html lang="en" class="notranslate" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Smart farm - Controller</title>
    <meta name="title" content="Smart farm landing page" />
    <meta name="description" content="Smart farm IoT buatan kelompok 1 X PPLG 2 SMKN 4 BOGOR. website ini adalah sebagai controller IoT yang bisa dikendalikan jarak jauh."/>
    <meta name="keywords" content="Smart Farming, IoT Farming, Farming Controller, Agricultural Technology, Smart Farming Solutions, Precision Agriculture, How to Use Smart Farming Controller, About Smart Farming Technology, Smart Agriculture Controller, Contact Smart Farming Team, Farming Automation, Smart Farming Dashboard, Remote Farm Monitoring, IoT Agriculture Solutions, Agriculture Sensor Controller, Automated Irrigation Systems, Farm Management Technology, Smart Farm Control System, Farming IoT Devices, Efficient Farming with Technology, Smart farm iot1, Smart farm smkn4 bogor, smart farm iot smkn4 bogor, controller smart farm smkn4 bogor, smart farm x pplg 2 smkn 4 bogor" />
    <meta name=" robots" content="index, follow" />
    <meta name="author" content="zeru-program" />
    <meta property="og:site_name" content="smartfarmcontroller"/>
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <!--Google Fonts and Icons-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/js-circle-progress/dist/circle-progress.min.js" type="module"></script>
    <link rel="shortcut icon" href="https://i.pinimg.com/474x/ef/f6/ac/eff6acfcf843833a9b21070769dae764.jpg"
    type="image/x-icon">
    <!-- style path -->
    <link rel="stylesheet" href="../assets/style.css" type="text/css" media="all" />
</head>

<body>
    <!--navbar -->
    <nav class="navbar navbar-expand-lg w-100  shadow-lg position-fixed" style="background:white;left:0;top:0;z-index:999;">
        <div class="container-fluid">
            <img src="../assets/logo.png" style="width: 50px;" alt="">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="bi bi-list"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link active fw-bold" href="/">Controller</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/">Home</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!--navbar -->

    <!--main content -->
    <main class="m-0" style="padding-top:65px">
        <!--display realtime sensor -->
        <section class="w-100 py-3 d-flex flex-column justify-content-center align-items-center bg-primarys gap-2"
            id="body-append-value-sensor">
            <div class="d-flex gap-2">
                <div class="d-flex flex-column p-2 box-sensor position-relative d-flex justify-content-center align-items-center"
                    style="background:#F2613F">
                    <p class="m-0 position-absolute" style="left:10px;top:5px">
                        Temperature
                    </p>
                    <h1 style="font-size:3em" class="m-0 mt-2 fw-bold" id="display-temp">0</h1>
                    <p class="m-0" id="sublime-temp">
                        Loading..
                    </p>
                    <p class="m-0 position-absolute" style="right:10px;top:5px">
                        °C
                    </p>
                </div>
                <div
                    class="d-flex flex-column p-2 box-sensor position-relative d-flex justify-content-center align-items-center">
                    <p class="m-0 position-absolute" style="left:10px;top:5px">
                        Kel. Udara
                    </p>
                    <h1 style="font-size:3em" class="m-0 mt-2 fw-bold" id="display-humidity">0</h1>
                    <p class="m-0" id="sublime-humidity">
                        Loading..
                    </p>
                    <p class="m-0 position-absolute" style="right:10px;top:5px">
                        %
                    </p>
                </div>
            </div>
            <div class="d-flex gap-2">
                <div class="d-flex flex-column p-2 box-sensor position-relative d-flex justify-content-center align-items-center"
                    style="background:#FF204E">
                    <p class="m-0 position-absolute" style="left:10px;top:5px">
                        Kel. Tanah 1
                    </p>
                    <h1 style="font-size:3em" class="m-0 mt-2 fw-bold" id="display-moisture1">0</h1>
                    <p class="m-0" id="sublime-moisture1">
                        Loading..
                    </p>
                    <p class="m-0 position-absolute" style="right:10px;top:5px">
                        %
                    </p>
                </div>
                <div class="d-flex flex-column p-2 box-sensor position-relative d-flex justify-content-center align-items-center"
                    style="background:gray">
                    <p class="m-0 position-absolute" style="left:10px;top:5px">
                        Kel. Tanah 2
                    </p>
                    <h1 style="font-size:3em" class="m-0 mt-2 fw-bold" id="display-moisture2">00</h1>
                    <p class="m-0" id="sublime-moisture2">
                        Comming soon..
                    </p>
                    <p class="m-0 position-absolute" style="right:10px;top:5px">
                        %
                    </p>
                </div>
            </div>
        </section>
        <!--display realtime sensor -->
        
        <!--controller -->
        <section class="container mt-4 d-flex flex-column">
            <h1 class="color-primary2 m-0 fw-bold">Farming Controller</h1>
            <p class="">
                Controll your farming in here (pastikan server sudah menyala dengan mengklik button 'START
                SERVER' dibawah)
            </p>
            <div class="d-flex gap-2 mt-2 align-items-center">
                <p class="m-0">
                    Kondisi Tanaman :
                </p>
                <div id="kondisi-tanaman">
                    <p class="bg-primarys m-0 px-3 py-1">
                        Loading..
                    </p>
                </div>
            </div>
            <div class="d-flex gap-2 mt-2 align-items-center">
                <p class="m-0">
                    System Farming :
                </p>
                <select name="" onchange="changeSystem(this)" class="bg-primarys border-0 px-3 py-1" value=""
                    id="system_mode_input">
                    <option value="" hidden>Loading..</option>
                    <option value="automatic">automatic</option>
                    <option value="manual">manual</option>
                    <option value="schedule">schedule</option>
                </select>
            </div>
            <div class="flex-wrap mt-3" id="auto-popup" style="display:none;">
                <h1 class="m-0">Automatic system</h1>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0">
                        Middle temperature (jika turun dingin, jika naik panas) :
                    </p>
                    <input class="form-control" id="mid-temp" type="number" />
                </div>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0">
                        Middle humidity (jika turun kering, jika naik lembab) :
                    </p>
                    <input class="form-control" id="mid-humi" type="number" />
                </div>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0">
                        Middle moisture1 (jika turun kering, jika naik lembab) :
                    </p>
                    <input class="form-control" id="mid-moisture1" type="number" />
                </div>
                <button class="btn btn-success" type="button" onclick="saveAutoMode()">Save</button>
            </div>
            <div class="flex-wrap mt-3" id="schedule-popup" style="display:none;">
                <h1 class="m-0">Scheduling system</h1>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0 col-4">
                        Pagi :
                    </p>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="pagi-ipt">
                        <div class="input-group-append">
                            <span class="input-group-text">:00</span>
                        </div>
                    </div>
                </div>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0 col-4">
                        Siang :
                    </p>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="siang-ipt">
                        <div class="input-group-append">
                            <span class="input-group-text">:00</span>
                        </div>
                    </div>
                </div>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0 col-4">
                        Sore :
                    </p>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="sore-ipt">
                        <div class="input-group-append">
                            <span class="input-group-text">:00</span>
                        </div>
                    </div>
                </div>
                <div class="d-flex gap-2 mt-2 align-items-center">
                    <p class="m-0 col-4">
                        Malam :
                    </p>
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="malam-ipt">
                        <div class="input-group-append">
                            <span class="input-group-text">:00</span>
                        </div>
                    </div>
                </div>
                <button class="btn m-2 btn-success" onclick="saveScheduleMode()" type="button">Save</button>
            </div>
            <canvas id="myChart" class="my-3" style="width:100%;max-width:700px"></canvas>
            <canvas id="myChartTemp" class="my-3" style="width:100%;max-width:700px"></canvas>
            <span class="text-center" id="status-server-span">Server : Loading...</span>
            <div class="container d-flex justify-content-center mt-3 mb-3">
                <button class="btn-on-off btno-active" id="btns-on" style="display:flex" onclick="server('on')">START
                    SERVER</button>
                <button class="btn-on-off btno-active"
                    style="display:none;background:#FF2842 !important;border:3px solid #FF2842 !important;"
                    id="btns-off" onclick="server('off')">TURN OFF SERVER</button>
            </div>
        </section>
        <!--controller -->
    </main>
    <!--main content -->

    <!--footer -->
    <footer class="footer position-relative py-3 text-center"
        style="padding-bottom:66px !important">
        <div class="mt-3" style="width:300px">
            <img src="../assets/logo.png" style="width:80px" alt="">
            <h3 class="foottitle">OneIoT SmartFarm</h3>
            <p class="m-0 px-3">
                SMKN 4 Bogor X-PPLG 2 group 1 Smart farm IOT project
            </p>
        </div>
        <div class="mt-3 d-flex flex-column">
            <h3 class="foottitle mx-auto">Navigation</h3>
            <a href="#home">Home</a>
            <a href="#about">About Us</a>
            <a href="#contact">Contact Us</a>
            <a href="#faq">FAQ</a>
        </div>
        <div class="mt-3">
            <h3 class="foottitle">Our Team</h3>
            <div class="con-team-footer">
                <p class="fw-bold">
                    Justine
                </p>
                <p class="">
                    Ali Yasir Fauzan
                </p>
                <p class="">
                    Ahmad Nur Khaaliq
                </p>
                <p class="">
                    Rizky Febriansyah Pratama
                </p>
                <p class="">
                    M. Bardan Sulaiman
                </p>
                <p class="">
                    M. Pachmi Alkamil
                </p>
                <p class="">
                    M. Sihab Budin
                </p>
                <p class="">
                    M. Egi Syarif
                </p>
            </div>
        </div>
        <div class="mt-3">
            <i class="bi bi-geo-alt-fill"></i>
            <p class="m-0">
                South Bogor, West Java, Indonesia.
            </p>
            <i class="bi bi-whatsapp"></i>
            <p class="m-0">
                +6287774487198
            </p>
            <i class="bi bi-whatsapp"></i>
            <p class="m-0">
                +6282114201343
            </p>
            <i class="bi bi-envelope"></i>
            <p class="m-0">
                zeruprogram@gmail.com
            </p>
        </div>
        <div class="mt-3 px-3 d-flex flex-column position-absolute"
            style="bottom:5px;color:#a1a1a1">
            <p class="m-0">
                © 2024 One iot X PPLG 2 SMKN4 BOGOR. All right reversed. v1.0
            </p>
        </div>
    </footer>
    <!--footer -->

      <!--footer -->
  <div class="w-100 vh-100 bg-light position-fixed justify-content-center align-items-center" style="top:0;left:0; display:none;z-index:9999999999999999;" id="spinner">
        <div class="spinner-grow text-success" role="status">
        </div>
    </div>
    <!--footer -->

    <!--popup alert-->
    <div class="m-0 w-100 shadow-lg position-fixed py-3" id="popup-alert"
        style="display:none;bottom:0;left:0; background:white; z-index:999;">
        <div class="container d-flex flex-column" style="background:white;">
            <h1 class="m-0">Recently Alert</h1>
            <div class="bar d-flex align-items-center gap-3 my-2">
                <p class="m-0 btna-active" id="btna-plant" onclick="showAlert('plant', this)">
                    Plant
                </p>
                <p class="m-0" id="btna-sensor" onclick="showAlert('sensor', this)">
                    Sensor
                </p>
                <p class="m-0" id="btna-pump-fan" onclick="showAlert('pump-fan', this)">
                    Pump/Fan
                </p>
            </div>
            <div class="display-alert flex-column  overflow-y-scroll px-2 rounded-2"
                style="width:100%;height:200px; background:rgba(0,0,0,.1);" id="alert-plant">
            </div>
            <div class="display-alert flex-column overflow-y-scroll px-2 rounded-2"
                style="display:none;width:100%;height:200px; background:rgba(0,0,0,.1);" id="alert-sensor">
            </div>
            <div class="display-alert flex-column  overflow-y-scroll px-2 rounded-2"
                style="display:none;width:100%;height:200px; background:rgba(0,0,0,.1);" id="alert-pump-fan">
            </div>
        </div>

        <button class="btn btn-danger position-absolute" onclick="closeAlert()" style="right:15px;top:15px;">X</button>
    </div>
    <!--popup alert-->

    <!--popup button-->
    <div class="m-0 w-100 shadow-lg position-fixed py-3" id="popup-btn"
        style="display:none;bottom:0;left:0; background:white; z-index:999;">
        <div class="container d-flex flex-column" style="background:white;">
            <h1 class="m-0">Control Pump or Fan</h1>
            <div class="display-alert mt-3 rounded-2 overflow-y-scroll"
                style="width:100%;height:200px; background:rgba(0,0,0,.1);">
                <div class="w-100 mt-3 container d-flex text-center gap-2 justify-content-center">
                    <div class="d-flex flex-column justify-content-center">
                        <h5 class="m-0 pb-1 fw-bold" style="color:#386c5f">Pump1</h5>
                        <div class="d-flex gap-2">
                            <button class="btn-on-off" id="pump1-btn-on" onclick="pumpButton('on', this, 1)">ON</button>
                            <button class="btn-on-off btno-active" id="pump1-btn-off"
                                onclick="pumpButton('off', this, 1)">OFF</button>
                        </div>
                    </div>
                    <div class="d-flex flex-column justify-content-center">
                        <h5 class="m-0 pb-1 fw-bold" style="color:#386c5f">Fan1</h5>
                        <div class="d-flex gap-2">
                            <button class="btn-on-off" id="fan1-btn-on" onclick="fanButton('on', this, 1)">ON</button>
                            <button class="btn-on-off btno-active" id="fan1-btn-off"
                                onclick="fanButton('off', this, 1)">OFF</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button class="btn btn-danger position-absolute" onclick="closeButton()" style="right:15px;top:15px;">X</button>
    </div>
    <!--popup button-->

    <!--btn popup button-->
    <button class="position-fixed justify-content-center shadow-lg align-items-center bg-primarys border-0" id="btn-btn"
        style="display:none;border-radius:50%;width:60px; height:60px;right:10px;bottom:20px;" onclick="openButton()"><i
            class="bi bi-hammer"></i></button>
    <!--btn popup button-->

    <!--btn popup alert-->
    <button class="position-fixed justify-content-center align-items-center bg-primarys border-0" id="btn-alert"
        style="display:none;border-radius:50%;width:50px; height:50px;right:10px;bottom:10px;"
        onclick="openAlert()"><i class="bi bi-bell"></i></button>
    <!--btn popup alert-->
    
    <!--asset js -->
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-storage-compat.js"></script>
    <script src="../assets/main.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">

        const firebaseConfig = {
            databaseURL: "https://controler-smart-farm-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);

        const database = firebase.database();
        document.getElementById("spinner").style.display = "flex"
        setTimeout(() => {

            document.getElementById("spinner").style.display = "none"
        }, 1200)

        database.ref("dataFarm").on("value", snapshot => {
            if (statusServer === 0) {
                var changeKondisiTanaman = document.getElementById("kondisi-tanaman");
                changeKondisiTanaman.innerHTML =
                '<p class="bg-danger text-light m-0 px-3 py-1">Server not started</p>';
                return;
            }
            var data = snapshot.val();
            if (data) {
                var moistureValue1 = parseFloat(data.moisture1);
                var changeKondisiTanaman = document.getElementById("kondisi-tanaman");

                if (moistureValue1 === 0 || moistureValue1 <= 50) {
                    changeKondisiTanaman.innerHTML =
                    '<p class="bg-danger text-light m-0 px-3 py-1">Kering</p>';
                } else if (moistureValue1 > 90) {
                    changeKondisiTanaman.innerHTML =
                    '<p class="bg-primary text-light m-0 px-3 py-1">Tanah lembab</p>';
                } else {
                    changeKondisiTanaman.innerHTML =
                    '<p class="bg-danger text-light m-0 px-3 py-1">Moisture not found</p>';
                }

                if (!data.error) {
                    var textTemp = document.getElementById("display-temp");
                    var textHumidity = document.getElementById("display-humidity");
                    var textMoisture1 = document.getElementById("display-moisture1");
                    var sublimeTemp = document.getElementById("sublime-temp");
                    var sublimeHumidity = document.getElementById("sublime-humidity");
                    var sublimeMoisture1 = document.getElementById("sublime-moisture1");

                    var intTemp = parseFloat(data.temperature);
                    var intHumidity = parseFloat(data.humidity);
                    var intMoisture1 = parseFloat(data.moisture1);

                    // Mengubah angka menjadi dua digit (01, 02, dst.)
                    var formattedTemp = String(intTemp).padStart(2, "0");
                    var formattedHumidity = String(intHumidity).padStart(2, "0");
                    var formattedMoisture1 = String(intMoisture1).padStart(2, "0");

                    textTemp.innerText = formattedTemp;
                    textHumidity.innerText = formattedHumidity;
                    textMoisture1.innerText = formattedMoisture1;

                    // Kondisi untuk temperature
                    if (intTemp === 0) {
                        sublimeTemp.textContent = "nothing";
                    } else if (intTemp > 20) {
                        sublimeTemp.textContent = "panas";
                    } else if (intTemp < 20) {
                        sublimeTemp.textContent = "dingin";
                    } else if (intTemp === 21) {
                        sublimeTemp.textContent = "stabil";
                    } else {
                        sublimeTemp.textContent = "error";
                    }

                    // Kondisi untuk humidity
                    if (intHumidity === 0) {
                        sublimeHumidity.textContent = "nothing";
                    } else if (intHumidity > 20) {
                        sublimeHumidity.textContent = "lembab";
                    } else if (intHumidity < 20) {
                        sublimeHumidity.textContent = "dingin";
                    } else if (intHumidity === 20) {
                        sublimeHumidity.textContent = "stabil";
                    } else {
                        sublimeHumidity.textContent = "error";
                    }

                    // Kondisi untuk moisture
                    if (intMoisture1 === 0) {
                        sublimeMoisture1.textContent = "nothing";
                    } else if (intMoisture1 > 50) {
                        sublimeMoisture1.textContent = "lembab";
                    } else if (intMoisture1 < 50) {
                        sublimeMoisture1.textContent = "kering";
                    } else if (intMoisture1 === 30) {
                        sublimeMoisture1.textContent = "stabil";
                    } else {
                        sublimeMoisture1.textContent = "error";
                    }
                }
            } else {
                alert("HTTP error");
            }
        });
        database.ref("dataRelay").on("value", snapshot => {
            var data = snapshot.val();
            var statusPumps = [];
            var statusFans = [];

            // Loop through each key-value pair in the JSON data
            for (let i = 1; i < 11; i++) {
                statusPumps[i] = data["pump" + i]; // Get the status (0 or 1)
                statusFans[i] = data["fan" + i]; // Get the status (0 or 1)

                // Check if pump status exists (even if it's 0)
                if (typeof statusPumps[i] !== "undefined") {
                    // Update pump buttons if status has changed
                    var btnOnPump = document.getElementById("pump" + i + "-btn-on");
                    var btnOffPump = document.getElementById("pump" + i + "-btn-off");

                    if (statusPumps[i] == 1) {
                        btnOnPump.classList.add("btno-active");
                        btnOffPump.classList.remove("btno-active");
                    } else if (statusPumps[i] == 0) {
                        btnOnPump.classList.remove("btno-active");
                        btnOffPump.classList.add("btno-active");
                    }
                }

                // Check if fan status exists (even if it's 0)
                if (typeof statusFans[i] !== "undefined") {
                    // Update fan buttons if status has changed
                    var btnOnFan = document.getElementById("fan" + i + "-btn-on");
                    var btnOffFan = document.getElementById("fan" + i + "-btn-off");

                    if (statusFans[i] == 1) {
                        btnOnFan.classList.add("btno-active");
                        btnOffFan.classList.remove("btno-active");
                    } else if (statusFans[i] == 0) {
                        btnOnFan.classList.remove("btno-active");
                        btnOffFan.classList.add("btno-active");
                    }
                }
            }
        });
    </script>
</body>
</html>